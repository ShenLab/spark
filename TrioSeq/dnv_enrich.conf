# 
# Specification for the format of variant table and definition of different variant classes
#
[Variant]
# One or more tables of annotated variants
Table=DNVTable.txt

# An optional over-all variant level filter
Filter='(ExAC_ALL=="." | ExAC_ALL<0.001) & (gnomADexome_ALL=="." | gnomADexome_ALL<0.001)'

# Variant exclusion list, with one or two columns VarID, [IID]
Exclude=/var/excl/list.txt

# Fasta file is optional, will be used to fetch local sequence context if provided
Fasta=/home/xz2680/Resources/GATK/b37/human_g1k_v37.fasta

# SampID will be used to link to sample info for defining sub-groups of samples
SampID=IID

# Variant classes
# Different from dnv_burden, we do not worry about overlapping gene here, no modifier is needed
Class=LoF
Class_Filter='GeneEff=~"splice_(acceptor|donor)" | GeneEff=="frameshift" | GeneEff=="stop_gained"'
Class=Dmis_MPC2
Class_Filter='GeneEff=="missense" & MPC!="." & MPC>=2.0'
Class=Dmis_CADD25
Class_Filter='GeneEff=="missense" & CADD13!="." & CADD13>=25'
Class=Silent
Class_Filter='GeneEff=="synonymous" | GeneEff=="start_retained" | GeneEff=="stop_retained"'

# For gene set enrichment analysis, we require that variant must be associated with genes! 
# So there is no need for non-genic class.

# Variant removeal list is different from exclusion list above.
# We do not deal with variant cluster in this pipeline, but can make use of removed variants
# from dnv_burden. It should have three columns: IID,VarID,GeneID; we will check those IDs by regex pattern
# The variant removal list is typically generated by dnv_burden or rarevar_burden pipelines.
# Make sure the same variant level filter is used in burden pipeline and this pipeline.
Remove=dnv_burden.varrm.txt

# It is possible to define class combination that assign different weights for different subclasses
Comb=Damaging
Comb_Define=LoF+Dmis_MPC2
Comb=NS
Comb_Define=LoF+0.333*Dmis_CADD25

# The list the variant classes or combination classes to be included in the analysis
Analysis=LoF,Damaging,NS,Silent


# Sample level information
[Sample]
# We do not need to known sample size for dnenrich analysis
# Sample groups can be defined either from sample table or variant table.

# Sample table, must be tab-separated, if not provided, we will get sample information from variant table
Table=SampInfo.txt
# Sample ID appear in the sample table
SampID=IID

# A list of bad samples to be excluded
#Exclude=BadSamps.txt
# A list of good samples to be included
#Include=GoodSamps.txt

# Overall sample table filter
Filter='Pheno!="Unaffected"'

# De novos shared by twin or sib pairs will only used once if both appear in the same sample group
Twins=MZTwins.txt
Sibs=Sibpairs.txt

# We do not use Sex information in dnenrich

# If we want include all samples, specify a dummy filter that always evaluates to true 
Group=All
Group_Filter='IID!=""'
Group=Complex
Group_Filter='ID=="TRUE" | EP=="TRUE"'
Group=Isolated
Group_Filter='ID=="FALSE" & EP=="FALSE" & ADHD=="FALSE"'
Group=Male
Group_Filter='Sex=="Male"'
Group=Female
Group_Filter='Sex=="Female"'


# Groups or group pairs included in analysis
#Analysis=All,Female:Male,Complex:Isolated
Analysis=All,Complex:Isolated

# Gene and gene sets
# The full gene list included in the burden analysis will be those included in the mutation rate table
# minus those specified in the backlist. Annotations to genes not in the full list will not be considered
# in the burden analysis unless otherwise specified.
[Gene]
# Blacklist (should contain gene IDs)
Exclude=/home/xz2680/Dropbox/Data/GENCODE/GencodeV19GeneTable_HGNC20180722_MUC-HLA-OR_blacklist.txt

# By default, genes in the size matrix exlcuding those in the exclusion list
# or keeping those in the inclusion list will form the background set
# But additional background set can be specified here using the same format
# used to specify gene sets
BackGround=/home/xz2680/Dropbox/Data/GeneMetrics/ExAC_r0.3.txt
BackGround_Fields=GeneID,"pLI>=0.5":Constrained

# We do not need to explicitly model chrX, so do not need HgBuild or DBTable

# Genes in variant table and gene sets are uniquely identified by GeneIDs
# To make the output readable, we need to provide gene names as alias to appear in the output. 
Alias=/Users/xzhou/Repository/Genes/HGNC/Processed/GencodeV19GeneTable_HGNC20180722.txt
Alias_Fields=EnsemblID,HGNC


# Gene set for test, here we use gene sets in gmt format
Set=/home/xz2680/Dropbox/Repository/Genesets/MSigDB/v6.2/c5.all.v6.2.gencodev19.gmt
Set_Fields=
Set=/home/xz2680/Dropbox/Repository/Genesets/MSigDB/v6.2/c2.cp.kegg.v6.2.gencodev19.gmt
Set_Fields=


# Gene size matrix
# It should follows the format specified by dnenrich, can be prepared by gene_sizemat.pl
# https://statgen.bitbucket.io/dnenrich/started.html#mng
# We can get the gene IDs from the header row
# Simialr to gene mutation rate table, we use GeneID to identify each gene
[GeneSize]
# Gene size table (matrix)
Matrix=/Users/xzhou/Dropbox/Data/Share/SPARK30K/Misc/hg19_mutrate_3mer_SPARK30K_genesizes.txt
# Specify the group label for each variant class defined above
# Each previous defined variant classes that are used in analysis 
# MUST have an associated label in the gene size matrix
VarClass=LoF:LoF,Dmis_MPC2:Dmis_MPC2,Dmis_CADD25:Dmis_CADD25,Missense:Missense,Silent:Silent


# Number of permutations
[PARAM]
NPERM=1000000


[BASH]
jobs=4

